1.GBLUP模型
代码使用的是混合模型，需要同时提供固定效应和随机效应(基因型数据)；目前只支持一个随机效应，即根据012格式的基因型数据生成的G矩阵；理论上对该代码进行修改可以添加或减少固定效应和随机效应，但不确定会不会报错。用公式表达就是 y=Xb+Zu+e；需要的两个方差值需要自己计算。

2.Bayes模型
同样使用BGLR包，跟之前的表型预测类似，区别在于：tmpBayes.R文件中24行，不再使用校正后的表型进行输入，而是直接把原始表型(y)和固定效应(c1,c2,c3)写入模型，再计算SNP的效应值和预测表型。根据相关参考(https://www.cnblogs.com/miyuanbiotech/p/17731341.html)，预测表型(yHat)-mu=GEBV，我理解的是该包从原始表型中剔除固定效应后，用校正后的表型和基因组数据构建了随机模型，所以可以用前述方式计算GEBV。

目前通过Bayes方法预测表型和育种值，绝大部分方法都是使用BGLR包，包括外包公司也是。但是对这个包的使用，我感觉需要多找参考和仔细甄别。

3.代码
tmpBayes.R和tmpGBLUP.R都是直接根据表型已知个体估计表型未知个体的GEBV，并计算其与校正后表型(*ebv_GBLUP.csv文件内容，自行计算)的相关系数，可以根据需要自己更换计算对象，比如直接计算与表型的相关系数。如果要输出具体结果需要修改代码导出对应的部分(参考注释)；这两个文件需要将*pheno_GBLUP.csv文件中未知表型个体的表型设置为NA，代码会自己分辨没有表型的个体。

tmpBayes_cross.R和tmpGBLUP_cross.R默认进行5折交叉检验，提供的表型、固定效应等文件不需要有NA值，执行后会自动从表型无缺的个体中抽出一部分将表型设置为NA，并计算这部分个体育种值与校正表型的相关系数。

上述的具体文件格式可以根据代码参考附带的文件。

Bayes方法和表型预测一样，可以通过修改model参数来选择不同的Bayes方法（BRR/BL/BayesA/BayesB/BayesC）；GBLUP方法与表型预测不同，不再是依靠BGLR包提供G矩阵进行表型预测，而是按照BLUP模型构建方法，对参数矩阵进行求解直接获取GEBV。

GBLUP方法最具有可信度的结果还是用已有的软件(BLUPF90、DMU、Asreml(要钱)等)，计算结果比较好解释，自己编写代码因为涉及到矩阵构建和过程求解、参数设置等细节问题，多少会出现一些差异。我的GBLUP代码求解过程是参考最基本的BLUP方程结构写的(https://blog.csdn.net/zjguilai/article/details/90605300)，遗传力参数稍有调整，相对来说比较原始，突出一个能用就行，可以作为参考，建议最好是根据自己的理解重写一遍。